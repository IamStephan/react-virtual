{"version":3,"file":"react-virtual.development.js","sources":["../node_modules/@reach/observe-rect/dist/observe-rect.esm.js","../src/useIsomorphicLayoutEffect.js","../src/useRect.js","../src/index.js"],"sourcesContent":["var props = ['bottom', 'height', 'left', 'right', 'top', 'width'];\n\nvar rectChanged = function rectChanged(a, b) {\n  if (a === void 0) {\n    a = {};\n  }\n\n  if (b === void 0) {\n    b = {};\n  }\n\n  return props.some(function (prop) {\n    return a[prop] !== b[prop];\n  });\n};\n\nvar observedNodes =\n/*#__PURE__*/\nnew Map();\nvar rafId;\n\nvar run = function run() {\n  var changedStates = [];\n  observedNodes.forEach(function (state, node) {\n    var newRect = node.getBoundingClientRect();\n\n    if (rectChanged(newRect, state.rect)) {\n      state.rect = newRect;\n      changedStates.push(state);\n    }\n  });\n  changedStates.forEach(function (state) {\n    state.callbacks.forEach(function (cb) {\n      return cb(state.rect);\n    });\n  });\n  rafId = window.requestAnimationFrame(run);\n};\n\nfunction observeRect(node, cb) {\n  return {\n    observe: function observe() {\n      var wasEmpty = observedNodes.size === 0;\n\n      if (observedNodes.has(node)) {\n        observedNodes.get(node).callbacks.push(cb);\n      } else {\n        observedNodes.set(node, {\n          rect: undefined,\n          hasRectChanged: false,\n          callbacks: [cb]\n        });\n      }\n\n      if (wasEmpty) run();\n    },\n    unobserve: function unobserve() {\n      var state = observedNodes.get(node);\n\n      if (state) {\n        // Remove the callback\n        var index = state.callbacks.indexOf(cb);\n        if (index >= 0) state.callbacks.splice(index, 1); // Remove the node reference\n\n        if (!state.callbacks.length) observedNodes[\"delete\"](node); // Stop the loop\n\n        if (!observedNodes.size) cancelAnimationFrame(rafId);\n      }\n    }\n  };\n}\n\nexport default observeRect;\n//# sourceMappingURL=observe-rect.esm.js.map\n","import React from 'react'\n\nexport default typeof window !== 'undefined'\n  ? React.useLayoutEffect\n  : React.useEffect\n","import React from 'react'\n\nimport observeRect from '@reach/observe-rect'\n\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport default function useRect(nodeRef) {\n  const [element, setElement] = React.useState(nodeRef.current)\n  const [rect, dispatch] = React.useReducer(rectReducer, null)\n  const initialRectSet = React.useRef(false)\n\n  useIsomorphicLayoutEffect(() => {\n    if (nodeRef.current !== element) {\n      setElement(nodeRef.current)\n    }\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    if (element && !initialRectSet.current) {\n      initialRectSet.current = true\n      const rect = element.getBoundingClientRect();\n      dispatch({ rect });\n    }\n  }, [element])\n\n  React.useEffect(() => {\n    if (!element) {\n      return\n    }\n\n    const observer = observeRect(element, rect => {\n      dispatch({ rect });\n    });\n\n    observer.observe()\n\n    return () => {\n      observer.unobserve()\n    }\n  }, [element])\n\n  return rect\n}\n\nfunction rectReducer(state, action) {\n  const rect = action.rect\n  if (!state || state.height !== rect.height || state.width !== rect.width) {\n    return rect\n  }\n  return state\n}\n\n","import React from 'react'\n\nimport useRect from './useRect'\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nconst defaultEstimateSize = () => 50\n\nexport function useVirtual({\n  size = 0,\n  estimateSize = defaultEstimateSize,\n  overscan = 0,\n  paddingStart = 0,\n  paddingEnd = 0,\n  parentRef,\n  horizontal,\n  scrollToFn,\n  useObserver,\n  onScrollElement,\n  scrollOffsetFn,\n}) {\n  const sizeKey = horizontal ? 'width' : 'height'\n  const scrollKey = horizontal ? 'scrollLeft' : 'scrollTop'\n  const latestRef = React.useRef({})\n  const useMeasureParent = useObserver || useRect\n\n  const { [sizeKey]: outerSize } = useMeasureParent(parentRef) || {\n    [sizeKey]: 0,\n  }\n\n  const defaultScrollToFn = React.useCallback(\n    offset => {\n      if (parentRef.current) {\n        parentRef.current[scrollKey] = offset\n      }\n    },\n    [parentRef, scrollKey]\n  )\n\n  const resolvedScrollToFn = scrollToFn || defaultScrollToFn\n\n  scrollToFn = React.useCallback(\n    offset => {\n      resolvedScrollToFn(offset, defaultScrollToFn)\n    },\n    [defaultScrollToFn, resolvedScrollToFn]\n  )\n\n  const [measuredCache, setMeasuredCache] = React.useState({})\n\n  const measurements = React.useMemo(() => {\n    const measurements = []\n    for (let i = 0; i < size; i++) {\n      const measuredSize = measuredCache[i]\n      const start = measurements[i - 1] ? measurements[i - 1].end : paddingStart\n      const size =\n        typeof measuredSize === 'number' ? measuredSize : estimateSize(i)\n      const end = start + size\n      measurements[i] = { index: i, start, size, end }\n    }\n    return measurements\n  }, [estimateSize, measuredCache, paddingStart, size])\n\n  const totalSize = (measurements[size - 1]?.end || 0) + paddingEnd\n\n  Object.assign(latestRef.current, {\n    overscan,\n    measurements,\n    outerSize,\n    totalSize,\n  })\n\n  const [range, setRange] = React.useState({ start: 0, end: 0 })\n\n  const element = onScrollElement ? onScrollElement.current : parentRef.current\n  useIsomorphicLayoutEffect(() => {\n    if (!element) { return }\n\n    const onScroll = () => {\n      const scrollOffset = scrollOffsetFn ? scrollOffsetFn() : element[scrollKey]\n      latestRef.current.scrollOffset = scrollOffset\n      setRange(prevRange => calculateRange(latestRef.current, prevRange))\n    }\n\n    // Determine initially visible range\n    onScroll()\n\n    element.addEventListener('scroll', onScroll, {\n      capture: false,\n      passive: true,\n    })\n\n    return () => {\n      element.removeEventListener('scroll', onScroll)\n    }\n  }, [element, scrollKey, size /* required */, outerSize /* required */])\n\n  const virtualItems = React.useMemo(() => {\n    const virtualItems = []\n    const end = Math.min(range.end, measurements.length - 1)\n\n    for (let i = range.start; i <= end; i++) {\n      const measurement = measurements[i]\n\n      const item = {\n        ...measurement,\n        measureRef: el => {\n          const { scrollOffset } = latestRef.current\n\n          if (el) {\n            const { [sizeKey]: measuredSize } = el.getBoundingClientRect()\n\n            if (measuredSize !== item.size) {\n              if (item.start < scrollOffset) {\n                defaultScrollToFn(scrollOffset + (measuredSize - item.size))\n              }\n\n              setMeasuredCache(old => ({\n                ...old,\n                [i]: measuredSize,\n              }))\n            }\n          }\n        },\n      }\n\n      virtualItems.push(item)\n    }\n\n    return virtualItems\n  }, [range.start, range.end, measurements, sizeKey, defaultScrollToFn])\n\n  const mountedRef = React.useRef()\n\n  useIsomorphicLayoutEffect(() => {\n    if (mountedRef.current) {\n      if (estimateSize || size) setMeasuredCache({})\n    }\n    mountedRef.current = true\n  }, [estimateSize, size])\n\n  const scrollToOffset = React.useCallback(\n    (toOffset, { align = 'start' } = {}) => {\n      const { scrollOffset, outerSize } = latestRef.current\n\n      if (align === 'auto') {\n        if (toOffset <= scrollOffset) {\n          align = 'start'\n        } else if (scrollOffset >= scrollOffset + outerSize) {\n          align = 'end'\n        } else {\n          align = 'start'\n        }\n      }\n\n      if (align === 'start') {\n        scrollToFn(toOffset)\n      } else if (align === 'end') {\n        scrollToFn(toOffset - outerSize)\n      } else if (align === 'center') {\n        scrollToFn(toOffset - outerSize / 2)\n      }\n    },\n    [scrollToFn]\n  )\n\n  const tryScrollToIndex = React.useCallback(\n    (index, { align = 'auto', ...rest } = {}) => {\n      const { measurements, scrollOffset, outerSize } = latestRef.current\n\n      const measurement = measurements[Math.max(0, Math.min(index, size - 1))]\n\n      if (!measurement) {\n        return\n      }\n\n      if (align === 'auto') {\n        if (measurement.end >= scrollOffset + outerSize) {\n          align = 'end'\n        } else if (measurement.start <= scrollOffset) {\n          align = 'start'\n        } else {\n          return\n        }\n      }\n\n      const toOffset =\n        align === 'center'\n          ? measurement.start + measurement.size / 2\n          : align === 'end'\n            ? measurement.end\n            : measurement.start\n\n      scrollToOffset(toOffset, { align, ...rest })\n    },\n    [scrollToOffset, size]\n  )\n\n  const scrollToIndex = React.useCallback(\n    (...args) => {\n      // We do a double request here because of\n      // dynamic sizes which can cause offset shift\n      // and end up in the wrong spot. Unfortunately,\n      // we can't know about those dynamic sizes until\n      // we try and render them. So double down!\n      tryScrollToIndex(...args)\n      requestAnimationFrame(() => {\n        tryScrollToIndex(...args)\n      })\n    },\n    [tryScrollToIndex]\n  )\n\n  return {\n    virtualItems,\n    totalSize,\n    scrollToOffset,\n    scrollToIndex,\n  }\n}\n\nfunction calculateRange({\n  overscan,\n  measurements,\n  outerSize,\n  scrollOffset,\n}, prevRange) {\n  const total = measurements.length\n  let start = total - 1\n  while (start > 0 && measurements[start].end >= scrollOffset) {\n    start -= 1\n  }\n  let end = 0\n  while (end < total - 1 && measurements[end].start <= scrollOffset + outerSize) {\n    end += 1\n  }\n\n  // Always add at least one overscan item, so focus will work\n  start = Math.max(start - overscan, 0)\n  end = Math.min(end + overscan, total - 1)\n\n  if (!prevRange || prevRange.start !== start || prevRange.end !== end) {\n    return { start, end }\n  }\n\n  return prevRange\n}\n"],"names":["props","rectChanged","b","observedNodes","run","changedStates","newRect","node","state","rafId","window","observeRect","cb","observe","wasEmpty","rect","hasRectChanged","callbacks","unobserve","index","cancelAnimationFrame","React","useLayoutEffect","useEffect","useRect","nodeRef","useState","current","element","setElement","useReducer","rectReducer","dispatch","initialRectSet","useRef","useIsomorphicLayoutEffect","getBoundingClientRect","observer","action","height","width","defaultEstimateSize","useVirtual","size","estimateSize","overscan","paddingStart","paddingEnd","parentRef","horizontal","scrollToFn","useObserver","onScrollElement","scrollOffsetFn","sizeKey","scrollKey","latestRef","useMeasureParent","outerSize","defaultScrollToFn","useCallback","offset","resolvedScrollToFn","measuredCache","setMeasuredCache","measurements","useMemo","i","measuredSize","start","end","totalSize","Object","assign","range","setRange","onScroll","scrollOffset","prevRange","calculateRange","addEventListener","capture","passive","removeEventListener","virtualItems","Math","min","length","measurement","item","measureRef","el","old","push","mountedRef","scrollToOffset","toOffset","align","tryScrollToIndex","rest","max","scrollToIndex","args","requestAnimationFrame","total"],"mappings":"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"}